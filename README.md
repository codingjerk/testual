# Testual

Testual is a C/C++ unit-testing framework, which is a pleasure to use.

## Quick usage example

Testual is a preprocessor for unit tests and a header file with some assert-macroses. Its run before included C/C++ preprocessor and do not a lot of work:
- Its finds all tests in a file, save its description and generate function. Function name will be generated depend on test name and it allow you to use special charracters and spaces in test name.
- Its generate main function that runs all tests, measures tests time and showing tests results.
- For all input test files will be generated only one cpp file with no dependencies (expect on testual.h, that must be in include-path) and prints it to stdout.
- After, you can compile and run result file and enjoy pregenerated main function and pretty output.

Now, lets watch it step-by-step:

### 1. Let's write some code to test:
```c
// facorial.cpp
// Code to be tested
#include <exception>

int factorial(int n) {
    if (n < 0) throw std::exception();
    if (n > 16) throw std::exception();

    if (n == 0) return 1;
    return n * factorial(n - 1);
}
```

### 2. And write some tests to that code
```c
// facorial.test
// Its a Testual code

// U can write a function prototype from cpp file, or write and include header file, doesn't matter
int factorial(int n);

// This is a simple test. Its use assert_throw, defined in testual.h
test negative factorial throws exception {
    assert_throw(factorial(-1));
}

test factorial on too big argument throws exception {
    assert_throw(factorial(100));
}

// This is test with name that contains special characters
test 0! == 1 {
    assert_equal(factorial(0), 1);
}

test factorial of first 3 Ns {
    assert_equal(factorial(1), 1);
    assert_equal(factorial(2), 2);
    assert_equal(factorial(3), 6);
}
```

### 3. Now u can generate program that will run that tests
```bash
$ testual factorial.test
```
but it will only print generated code. To generate and compile in one command, run:
```bash
$ testual factorial.test | g++ factorial.cpp -xc++ -
```
thats mean - run g++ to compile factorial.cpp and code from stdin (generated by Testual) and generate executable file (by default a.out). Now you can run this file and remove it after tests will pass.
```bash
$ testual factorial.test | g++ factorial.cpp -xc++ -; ./a.out; rm ./a.out
```

### 4. Now you get pretty results in your terminal:
![Imgur](http://i.imgur.com/zhinlnH.png)

If you write some bad tests, it will show you error with a lot of info:
![Imgur](http://i.imgur.com/UWHy0uX.png)

## Installation

Now testual available only for unix-like systems, so installation is usual:
```bash
$ git clone https://github.com/d3adc0d3/testual.git
$ cd testual
$ make
$ make install (as root)
```

## What you need to know before using Testual

On current stage, testual use some dirty hacks instead of true C/C++ parsing (its really hard to implement, because C++ is complex language). So you may encounter errors. Create an issue in official repository on bitbucket or github. Its all about current minuses.

You must know, that Testual is both C and C++ framework, so you can use it in any ะก/ะก++ project.

## FAQ
### Why no suites/cases?
Use files instead of classes for test suites.

## Fast comparison with other frameworks (only code, without comments)

### Testual
```C++
int factorial(int n);

test negative factorial throws exception {
    assert_throw(factorial(-1));
}
    
test factorial on too big argument throws exception {
    assert_throw(factorial(100));
}

test 0! == 1 {
    assert_equal(factorial(0), 1);
}

test factorial of first 3 Ns {
    assert_equal(factorial(1), 1);
    assert_equal(factorial(2), 2);
    assert_equal(factorial(3), 6);
}
```

### CxxTest
```C++
#include <cxxtest/TestSuite.h>

int factorial(int n);

class FactorialTestSuite1: public CxxTest::TestSuite {
public:
    void testNegativeNsThrowsException() {
        TS_ASSERT_THROWS_ANYTHING(factorial(-1));
    }
    
    void testTooBigNsThrowsException() {
        TS_ASSERT_THROWS_ANYTHING(factorial(100));
    }
    
    void testFactorialOfZeroIsOne() {
        TS_ASSERT_EQUALS(factorial(0), 1);
    }
    
    void testFirst3Ns() {
        TS_ASSERT_EQUALS(factorial(1), 1);
        TS_ASSERT_EQUALS(factorial(2), 2);
        TS_ASSERT_EQUALS(factorial(3), 6);
    }
};
```
